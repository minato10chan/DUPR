# 🏓 PicklePair - ピックルボール練習会運営アプリ

ピックルボール練習会でのダブルス試合運営を円滑化するための、スマートフォン最適化されたWebアプリケーションです。

## ✨ 主な機能

### 🎯 スマートな試合生成
- **スキルバランス自動調整**: Eloレーティングシステムによる実力を考慮したチーム分け
- **試合数均等化**: 全プレイヤーの試合数を均等になるよう自動調整
- **ペア重複回避**: 同じペアでの連続対戦を可能な限り回避

### 📱 モバイル最適化UI
- **タブベース設計**: 試合進行・参加者管理・ランキングの3つの主要機能
- **カードデザイン**: 視覚的にわかりやすい情報整理
- **大型ボタン**: タッチしやすいUI設計

### 📊 詳細な統計管理
- **リアルタイムランキング**: 勝率・スキルポイント別のランキング表示
- **個人成績追跡**: 試合数、勝率、スキル変遷の記録
- **試合履歴**: 過去の試合結果の詳細表示

## 🚀 クイックスタート

### 必要な環境
- Python 3.8以上
- pip (Python package installer)

### インストール手順

1. **リポジトリのクローン**
```bash
git clone <repository-url>
cd PicklePair
```

2. **依存関係のインストール**
```bash
pip install -r requirements.txt
```

3. **アプリケーション起動**
```bash
streamlit run app.py
```

4. **ブラウザでアクセス**
- ローカル: http://localhost:8501
- スマートフォンからアクセスする場合は、同じWi-Fi内での外部アクセスを有効にしてください

## 📖 使用方法

### 1. 初期設定
1. **プレイヤー登録**: 「管理」タブ → 「プレイヤー管理」から参加者を登録
2. **参加者選択**: 「参加者」タブで当日参加するプレイヤーの「今日の参加」をON

### 2. 試合運営
1. **試合生成**: 「試合進行」タブで設定を調整し「試合を生成」をクリック
2. **結果入力**: 各試合カードの「スコア入力」から結果を記録
3. **ランキング確認**: 「ランキング」タブで最新の順位を確認

### 3. 詳細機能
- **休憩機能**: 「参加者」タブで一時的に参加を停止可能
- **スキルマッチング**: ON/OFFでバランス調整方式を切り替え
- **履歴閲覧**: 「管理」タブから過去の試合履歴を確認

## 🏗️ システム構成

```
PicklePair/
├── app.py                   # メインアプリケーション
├── config/
│   └── settings.py          # システム設定
├── models/
│   ├── player.py            # プレイヤーデータモデル
│   └── match.py             # 試合データモデル  
├── services/
│   ├── player_service.py    # プレイヤー操作ロジック
│   └── match_service.py     # 試合操作ロジック
├── utils/
│   ├── data_manager.py      # データ永続化
│   └── match_generator.py   # 試合生成アルゴリズム
└── pages/
    ├── user_management.py   # プレイヤー管理ページ
    └── match_history.py     # 試合履歴ページ
```

## 🧮 アルゴリズム詳細

### スキル更新システム (Eloレーティング)
- **K値**: 32 (標準的な調整幅)
- **初期値**: 50ポイント
- **更新式**: `新スキルポイント = 旧ポイント + K × (実結果 - 期待勝率)`

### 試合組み合わせ最適化
1. **プレイヤー選定**: 試合数が少ない順に4人を選択
2. **チーム分割評価**: 3つのパターン（AB vs CD, AC vs BD, AD vs BC）を比較
3. **評価基準**: 
   - スキルマッチングON時: チーム間スキル差の最小化
   - スキルマッチングOFF時: ペア対戦重複の最小化

## 📊 データ管理

- **保存形式**: JSON形式でローカル保存
- **保存場所**: `data/pickle_pair_data.json`
- **バックアップ**: 自動バックアップ機能付き
- **アトミック書き込み**: データ破損防止のため一時ファイル経由で保存

## ⚙️ 設定可能項目

| 設定項目 | デフォルト値 | 説明 |
|---------|-------------|-----|
| コート数 | 2 | 同時進行する試合数 |
| K値 (Elo) | 32 | スキルポイント変動幅 |
| 初期スキルポイント | 50 | 新規プレイヤーの開始値 |
| 最大コート数 | 10 | システム制限値 |
| 試合生成数 | 1-10 | 一度に生成可能な試合数 |

## 🛠️ トラブルシューティング

### よくある問題と解決方法

**Q: 試合が生成されない**
A: アクティブなプレイヤー（参加中かつ非休憩）が4人以上いることを確認してください。

**Q: データが保存されない**
A: `data/`フォルダの書き込み権限を確認してください。

**Q: スマートフォンからアクセスできない**
A: Streamlitを `--server.address 0.0.0.0` オプション付きで起動してください。

**Q: スキルポイントが更新されない**
A: 試合結果を正しく記録し、勝敗が決定していることを確認してください。

## 🤝 コントリビューション

プルリクエストや Issues は大歓迎です！

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを開く

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルをご覧ください。

## 📞 サポート

質問や不具合報告は GitHub Issues までお願いします。

---

**開発者**: PicklePair Development Team  
**バージョン**: 1.0.0  
**更新日**: 2024年 